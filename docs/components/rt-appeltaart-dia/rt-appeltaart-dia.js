const[e,t]=rtlib.parseCompURL(import.meta.url);customElements.define(e,class extends rtBC.RTBaseClass{#e;constructor(){super(),this.#e=this.attachShadow({mode:"open"}),this.#e.append(this.$getTemplate()),this.getMenu(),this.#e.querySelector("#x img").src=`${t}/img/close-wht.png`,this.addEventListener("neworder",e=>this.dispatchOrder(e)),this.#e.querySelector("#x").addEventListener("click",()=>this.#e.querySelector("dialog").close())}connectedCallback(){}async getMenu(){let e=this.#e.querySelector("dialog");const s=this.$attr("datafile");if(null!==s&&""!==s){const a=`${t}/${s}`;try{const t=await fetch(a);if(!t.ok)throw`Failed to load ${a} with status ${t.status}`;const s=await t.text(),o=document.createRange().createContextualFragment(s);e.appendChild(o)}catch(e){console.warn(e)}}else{const t=document.createRange().createContextualFragment('<h1 style="color: red;">datafile attribute not provided</h1>');e.appendChild(t)}}dispatchOrder(e){if(e instanceof Event&&e.stopPropagation(),e.detail){const t="http://localhost:5100/dev/API/sendmail.php",s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:"item-line",order:e.detail.order,details:e.detail.person})};fetch(t,s).then(e=>{if(e.ok)return e.text()}).then(e=>{"OK"===e.slice(-2)&&"NOK"!==e.slice(-3)?this.#e.querySelector("rt-orderform").accepted():(alert("Order submission failed"),console.warn(e))})}}show(){this.#e.querySelector("dialog").showModal()}});